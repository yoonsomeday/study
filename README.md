# study
[blog.naver.com/lys33984](https://blog.naver.com/lys33984/222736671455)


• EC2 생성시-EBS CElaste Block Storage) 생성
4.53 보다 비싸
• 생성시 101 크기를 204. (줄이는거 불가)
502153) 3 800f45 이용동에서 연결
•IAM > 프로그래밍 방식 액제고 쓰
aus configs
77. 0478
•53 - 버킷 생성 - 정책, 주가 E(2에 900143 설치(floe, golang 설치를)
aketti moient
ronti 4501. - chiconfiganent
실행주체가 'rof'라
vo 밑은 crecentiap은
을거리
Aws egethater 한용에게
- ML (기계학습) 빨리 구축,최습, 배포
• 완전 관리형 서비스
Jupyter, Anacoda M7!
인스타스 type t-m-C -p (과서는. 비용이 ^) 
IAML livage 로 EC2 생성후, EBS VOl Size 구성 버정
ex) AMI a, with
* mont 상태, 서비스 중단 x
50GB
(00GB
• 파일 시스템 unam 하고
CTv 상 공성 변정

AMl tunge 2 EC2 생성후, EBS Wal Size 무성 변정
ex) AMI my with
* momt 상태, 서비스 중단 x
50GB
(00GB
• 파일 시스템 Umam하고
Dtme상구성변겅0.
• fas -1 확인 전에
10061.500133 gAnTTrion Ent.
grow pert
30G- 100993 최대로 001110편 늘리기
•(P) 3 PV 입장은 이직인식*
presize
(495) 109761 0121671247
'Ivextend x75-growfs
: f5을 원하는 용량으로 확장.
(df -hz で,)
Aws cloud 도입 검토 가이르
• on premise 대비 , 주시성 유연성. 가격호율성
• 조직 전체 전략적 관점.
- 전혀 세로운 기술 , 새로운 IT 라이프 사이를
- 조직 정보기술 환경의 때러리임을 변경
• 단위한 4부서의 결정 사항x, - 비니스적 전략 필요
- 클라우드 컴퓨팅의 이잠을 전직관전에서 아니트, 도입
194 ME
Bustusess
Valan
platforen
구축 은엽~ 집의 이키럭처
• Maturzy (성숙도, 단백로)
People
인국구성. 가장 반화를 이끌어내기 어려도.
Process
계속 구축-운업 비즈니스 1700년55 준비.



Cloud 서비스
* Cioud 서비스
LG Encload 서비스
. frietwatreed Multi-Terant fervar
. 신한 286 자원.
• Opern stade 기반
• 기준 15ga대와 통신 가능.
2554 7104.
vegton
/ A2X2
saver, storage, power 독립적으로 구성,
* LCm : 서비간 neturl 구성, 통신지원 (UpO)
*compute
~ V/IM an here agentle
Bave metal Iserru (다, 고성동)
- altoscalling
+6407894
1 Grandard
for apptication
prenion Volume- oy fike lon
• All flash vol
- 505
* was storage
Gentler
- 여리대의 host에서 쉽게 공유
병대 공유성.
• 동시집로0k,
*Ob74044 starage
- Server diet
Ike container
web a 56479
40, 210 Fol Nevicia de,

Obtect storage
- seve set iike contather
• weh = 556 479.
40, 210 Fat Revica de
restful apt (53)
자부적으로 증가하는
• Budeet ezttz t
daft nodie
(buces
*541 2 0183.
스닝샷 2 트랑시엄 Sterage darta
• 동일한 이마지 Semor
볼륨백업.타 Gorage 저상공간에 복제야
•Obfeet sterage에 저랑
* Network
기산석비판 (UP(), 1egiry, 전월트신
< 내타서비판. : 방원의 하는 부시 구성이 필인가.
2481% ON.
" 승신(Ourbound) 데이터 전송량에 따라 경량과금
VpC C Sutnet 간의 통신 , 수신 과로X.
1G Encloud regian
K16701
DMZ
* DSR LB
• 부하분산 ((4) 가상 디) 당 과금
100401
Vivi
"Actve / Stanlby 이중화 구성
•proay 방3 x . sSR I direet servcr
return)


DSR LB
• 부하분산 (14) 기상고) 당 과금
"Active / Stanlly 이중화 구성
POy 방3 X. BSR I direct server
A CON MI
• 대용량 dM이를 베스로 안전하게 전문.
1. 종량세기만
* 방화역 서비스 (VFW)
. VPC를 보호하가위하니
95-cH001
futbol
Vimi
AIDS
4551 - UPA
• VPC 힘입차단 보안을 위해이
• 외부원력전에서 내부진. 인증. 임호화



AWS

클라우드 환경의 특징
- 물리적 리소스에 대한 제어권한을 가지고있냐의 유무
- 리소스의 사용량 /시간에 따라 비용 지불

- 모든 리소스는 프로그래밍 가능한 형태
- 글로벌한/ 가용한/ 무제한 용량
- 높은 수준의 관리 서비스
- 보안기능

클라우드 아키텍처 구조
- Physical layer : 시스템 인프라
- Logical layer : 시스템 인프라를 할당할수있게 논리적으로 분리
- Platform layer : was/dbms 등 주요 엔진들을 포함
- Service layer : 어플리케이션 / laas, paas 사용시 제공되는 관리, 보안 환경 포함
클라우드 서비스 모델 구성도
- Laas : 시스템 인프라(physical/ logical layer) 제공 / 서버, 스토리지, 디비,네트워크..
- Paas : 소프트웨어 개발을 위한 환경 (physical/logical/platform)/os, dbms,was
- Saas : 사용자가 바로 사용할 수있는 어플리케이션 (전 layer제공)

- Repost : 하드웨어 교체만 의미
- Replatform : 클라우드에 적합한 소프트웨어로 변경 / 마이그래이션 수행
- Refactor : 클라우드 솔루션을 적극 사용


*CI/CD

- Deploy  : code deploy, ElasticBeanstalk, Opsworks

*통합 아키텍처 설계 고려사항
- Rehost
- Replatform : 일부 소프트웨어만 변경
- Refactor : 클라우드 환경에 적합한 아키텍처로 변경

- 확장에 대한 설계 
    - Lb, stateless, scale-in(제거시)
- 느슨한 결합 구조
    - 수평적 확장
    - 외부 별도 정보 저장소 (cache, queue)
- 자동화 설계
- 장애발생에 대한 설계 (MTTF)
- 다중처리 설계 : 멀티 쓰레딩, 병렬화
- 성능에 대한 설계 : 지연시간 (Latency)
    - Data read/write
    - Cache
    - 정적데이터 처리 (S3)
- 정합성에 대한 설계
    - 데이터 파티셔닝

참조 아키텍처 패턴
- N-tier : layer
    - Web/middle/data tier로 구분
- Queue-worker : front-end, back-end가 queue 기반 메세징
- Microservice 아키텍처 : 작은 단위로 기능을 분리
    - Api 호출 방식 + Service Discovery, API Gateway (endpoint들을 단일화로 묶고, 인증 인가 역할도)
- CQRS 아키텍처
    - Command and query responsibility segregation):db 읽기 쓰기 구분

표준 아키텍처
- Contents delivery -> api layer ->application layer -> persistency layer

Read Replica 동기화 방안
- Sync/Async Stream replication
- CDC (change data capture) : RDS에서만 지원
- Kafka + Avro : 스트리밍 데이터를 전송. 분산 메시징 시스템 , was zookeeper +EBS

*네트워크
- Region > AZ > VPC (여러 AZ를 걸칠수있다.- 권장) > subnet > routing table (내외부 통신을 위한 정보), Route 53(내부 인스턴스가 외부와 통신할때/ 도메인)
- Region 안에 AZ들은 독립적으로 되었있다. (장애 공유X)
- VPC : private IP 대역 사용하는 서버 그룹들과 1차적으로 접근을 제어한다./ 논리적으로 격리된 가상네트워크
- Subnet : vac ip 주소범위의 한 세그먼트
-  Internet gateway : vpc 측 게이트웨이
- NAT gateway : private subnet의 리소스가 인터넷에 액세스하기 해주는 서비스
- 라우터 : 서브넷 상호연결
- 피어링 연결 : private ip통해 두 vpc간의 연결
- Vpn 엔드포인트 : 인터넷 게이트웨이나, NAT을 사용하지않고 vpc내에 있는 AWS S3에 액세스

- 내외부망 분리
    - vpc안에 서브넷을 프라이빗/ 퍼블릭으로 구분
- 티어별 분리 : 특별한이유로 (DB)서브넷을 각각 분리

분리된 vpc간의 통신방안
: vpc endpoint 도입 - vpc에 위치/ 피어링은 대역이라 보안에 설정이 더 많음 귀찮음, 다른 account, region의 vpc와 연결 불가, 두 vpc간의 cidr 중복될경우

대표적인 vpc 외부 리소스
- S3
- Sqs
- dynamoDB
- Code commit/ code deploy

NAT 구성
    - Public subnet에 NAT gateway를 구성하고 private subnet에서 NAT gateway를 거쳐 나간다.
    - Vpc endpoint를 더 권장
접속환경 구성
- Bastion host 구성 : private subnet을 접속하기 위한 proxy 역할
- ec2를 public subnet에 둔다. 베스쳔 host가 공격당하면 위험하니 허용 포트를 잘 관리해야한다.

*보안
- Vpc 제공
- IAM  
- security group (2차 방어) 
    - vpc내 subnet각각에 sg 할당 가능
    - 같은 subnet안에 있는 인스턴스 통신하는 경우에도 sg 정책 필터링 된다.
    -  allow 지정방식
    - Outbound 트래픽인 경우는 all allow 원하는 규칙 추가
    - stateful한 방화벽으로 허용된 inbound 트래픽의 응답은 outbound 상관없이 허용

*데이터베이스
RDS vs EC2 db 배포
- RDS : 배포 자동화, 고가용성, 성능 스키마 최적화에 집중
- 후자 : 전세계 ec2 가능 지역에서 가능, rds에서 불가능한 기능 가능, 지원하지않는 db사용시

RDS 종류
- RDS : 관계형 db
- Aurora : mysql 호환 관계형
- DynamoDB : NoSQL, key-value
- Redshift : 페타바이트 규모의 완전관리형 data ware house
- ElasticCache : memcache 또는 redis기반 인 메모리


*EKS
Control plane
- ECS : 클러스트에서 Docker컨테이너를 쉽게 실행,중지,관리 해주는 컨테이너 관리 서비스
    - 컨테이너식 어플리케이션을 쉽게 실행 확장 축소 가능
- EKS: k8s를 사용하는 컨테이너식 어플리케이션 관리형 환경
Data plane
- Fargate
- EC2

Elastic Beanstalk : 가장 쉽게 웹 어플리케이션/ 서비스를 배포 ,확장,관리 할수 있는 완전관리형 서비스
Fargate : 서버 및 클러스트를 관리할 필요없이 컨테이너를 실행 해줄수있게 해주는 컴퓨터 엔진,
사용자는 컨테이너,cpu,메모리,네트워크 ,iam정책 설정등을 통해 어플리케이션을 정의 해주면됨.

cloudwatch에서 eks 지원 안함.(worker node에 생성되는 ec2 모니터링 정도만.)
따로 모니터링 툴 필요 : k8s native dashboard, prometheus, grafana

*2. 서버리스 컴퓨팅이란 무엇인가?
- 사용자는 코드에만 집중할수있다.
- 실행한 만큼 비용발생
- 단점 : 시간제한,동시실행수 제한, 공급업체의 종속성, 신기술이 가진 불안감

*3. 서버리스 컴퓨팅 특징
- 내부적으로 컨테이너 기반으로 되어있지만 사용자들은 인지할 필요없다.
- 함수(코드)를 등록하고 트리거로 호출하면 동작하는 방식
- 서버 관리 필요 없어서 비즈니스 로직에만 집중 가능
- 요청수에 따라 자동으로 확장가능
- 실행 시간, 요청 횟수로 비용이 발생 (자주 사용하지 않는 경우 저렴)

*4. 서버리스 컴퓨팅 도입시 고려사항
- 공급업체의 종속성 /업체별 다 달라서 멀티 클라우드 어렵다
- 공급업체의 종속성을 피하려면 오픈소스 서버리스 컴퓨팅 플랫폼을 이용해야함
- 공급 업체마다 sla 상이함. —> 크리티컬한 업무에는 서버리스 컴퓨팅을 사용 자제
- 서버리스 컴퓨팅은 단독으로 실행 못하므로 연계 서비스가 많이 필요. “보안의 이유로 필요한 권한만 사용하는 것 중요”
- 최대로 동작하는 함수 수 제한 / 사용하지않는 컨테이너를 반환하고 호출시 다시 할당하는 과정에 발생하는 지연 시간 존재
- 오래 동작하는 서비스인 경우 함수를 더 잘게 쪼개 사용하거나 가상머신같은 serverfull한 서비스를 이용해야함. 
- 최대한 실행시간이 초과된 함수의 재시도는 호출단에서 처리하는게 안전하다.
- 동시 실행수 오류가 발생한

6. 서버리스 컴퓨팅 아키텍처 설계
- 대규모 아키텍처엔 부적합 (복잡해져서 관리가 안됨)
- 




Azure & GCP

Azure > 클라우드 개발 가이드 >  
*아키텍처
- Virtual machines (laas)
- Cloud service(paas)
- App service (paas)
    - 앱서비스
    - 앱서비스 플랜 - 리소스 컬렉션
    - 리소스 그룹 - 관리 단위 

- Micro service 적합 > service fabric 
    - 새앱만들거나 기존앱을 다시 작성하는 경우 적합

*설계 및 구현
분산 서비스 호출 방식
- decentralized : lb와 대응
- Distributed : api management 대응

서비스 디스커버리 방식
- 여러서버에 나눠진 서비스를 유레카나 api management 같은 서비스를 이용해서 호출
서비스 분배
- Lb (전송 수준 / l4/)
- Gateway (응용 프로그램 수준 / l7/ uri로 컨트롤 가능)
서비스 연계
- 분산 트랜잭션 (2 phase commit/ titely-coupled /권장 안함)
- 메세지 큐 방식(1 pc / 비동기/loosely-coupled/대용량 적합)
- 분산 서비스 호출 방식 (1pc/동기/매카니즘 복잡)
REST 연계
- Gatewqy server : (front endpoint를 구성/backend service 구현 / azure api management로 제공)
- Proxy server : proxy 형태로 backend server에 전달 / lb로 가능
- DNS : ip를 rr형태로 backend server에 전달 / DNS로 가능

환경파일 공유
- Azure blob

Azure > 클라우드 아키텍처 가이드 >  
- 리소스
- 멀티 테넌시
*데이터 이행 방안
- DMA (data migration assistant) : 동종 dbms간의 이관만 지원
- ADF(azure data factory) : 데이터 이동, 오케스트레이션, 자동화 파이프라인 데이터 통합 서비스

*서버
- Vm / app service / service fabric/azure container service/function/  batch / cloud service
*스토리지
- Blob storage (sql db/ cosmos db)
- File storage
- Queue storage
- Table storage : noSQL key-value
*네트워크
- Region
- Virtual network(vnet)
- Lb
- Application gateway(l7 / url 기반 라우팅)
- Traffic manager(트레픽 분산 서비스)
- Azure DNS
- VPN gateway(암호화된 트래픽 전송)
- Expressroute(전용선)
- Content delivery network (개체 캐싱)
- Network watcher (네트워크 성능 진단 솔루션)

- NSG (네트워크 보안 그룹) : ip/port/protocol기준으로 트래픽 필터링 가능, vm의 nic에 적용 가능
- NVA (네트워크 가상 어플라이언스) : 방화벽 같은 네트워크, vnet 필터링



